@using hub.Shared.Models.Todo
@using Microsoft.Extensions.Logging
@using hub.Client.ViewModels.Todo
@using System.ComponentModel
@using hub.Client.Views.Components.Todo

@implements IDisposable
@inject ILogger<TodoAllView> Logger
@inject ITodoAllViewModel ViewModel

<TodoEntry Item="@ViewModel.PendingTodoModel" SaveCommand="@ViewModel.Save"/>

@foreach (var item in ViewModel.Todos)
{
	<TodoItem 
		Item="@item.TodoModel" 
		Completion="@item.TodoCompletion" 
		DeleteCommand="@ViewModel.DeleteItem"
		SetCompletionCommand="@ViewModel.ToggleItem"
	/>
}

@code {
	protected override void OnInitialized() {
		base.OnInitialized();
		ViewModel.StateChanged += StateHasChanged;
	}

	public void Dispose()
	{
		ViewModel.StateChanged -= StateHasChanged;
	}
}

